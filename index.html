<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 2018-08-03 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20180803" />
    <meta http-equiv="Content-Language" content="en" />
    <title>microBean DataSource CDI: HikariCP &#x2013; microBean Hikari Connection Pool CDI Integration</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>microBean DataSource CDI: HikariCP</h2>
</div>
</div>
        <div class="pull-right"><a href="./" id="bannerRight"><img src="https://avatars0.githubusercontent.com/u/25515632?s=60"  alt="Î¼b microbean-datasource-cdi-hikaricp"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2018-08-03</li>
      <li id="projectVersion" class="pull-right">Version: 0.0.2</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Documentation</li>
    <li class="active"><a href="#"><span class="none"></span>Overview</a>
  </li>
    <li><a href="apidocs/index.html" title="JavaDocs"><span class="none"></span>JavaDocs</a>  </li>
    <li><a href="https://github.com/microbean/microbean-datasource-cdi-hikaricp/" class="externalLink" title="Github Repository"><span class="none"></span>Github Repository</a>  </li>
    <li><a href="examples.html" title="Examples"><span class="none"></span>Examples</a>  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
      <ul class="nav nav-list">
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a>  </li>
    <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a>  </li>
    <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a>  </li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>About</a>
  </li>
    <li><a href="issue-tracking.html" title="Issue Management"><span class="none"></span>Issue Management</a>  </li>
    <li><a href="license.html" title="Licenses"><span class="none"></span>Licenses</a>  </li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a>  </li>
    <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a>  </li>
    <li><a href="team-list.html" title="Team"><span class="none"></span>Team</a>  </li>
    <li><a href="source-repository.html" title="Source Code Management"><span class="none"></span>Source Code Management</a>  </li>
    <li><a href="project-summary.html" title="Summary"><span class="none"></span>Summary</a>  </li>
      </ul>
  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >
<h1>microBean Hikari Connection Pool CDI Integration</h1>
<p><a class="externalLink" href="https://travis-ci.org/microbean/microbean-datasource-cdi-hikaricp"><img src="https://travis-ci.org/microbean/microbean-datasource-cdi-hikaricp.svg?branch=master" alt="Build Status" /></a> <a class="externalLink" href="https://maven-badges.herokuapp.com/maven-central/org.microbean/microbean-datasource-cdi-hikaricp"><img src="https://maven-badges.herokuapp.com/maven-central/org.microbean/microbean-datasource-cdi-hikaricp/badge.svg" alt="Maven Central" /></a></p>
<p>The microBean Hikari Connection Pool CDI Integration project integrates the <a class="externalLink" href="http://brettwooldridge.github.io/HikariCP/">Hikari connection pool</a> into <a class="externalLink" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#part_2">CDI 2.0 SE environments</a>.</p>
<h1>Installation</h1>
<p>To install the microBean Hikari Connection Pool CDI Integration project, ensure that it and its dependencies are present on the classpath at runtime. In Maven, your dependency stanza should look like this:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;dependency&gt;
  &lt;groupId&gt;org.microbean&lt;/groupId&gt;
  &lt;artifactId&gt;microbean-datasource-cdi-hikaricp&lt;/artifactId&gt;
  &lt;!-- See http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.microbean%22%20AND%20a%3A%22microbean-datasource-cdi-hikaricp%22 for available releases. --&gt;
  &lt;version&gt;0.0.1&lt;/version&gt;
  &lt;type&gt;jar&lt;/type&gt;
  &lt;scope&gt;runtime&lt;/scope&gt;
&lt;/dependency&gt;
</pre></div></div>
<p>Releases are <a class="externalLink" href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22org.microbean%22%20AND%20a%3A%22microbean-datasource-cdi-hikaricp%22">available in Maven Central</a>. Snapshots are available in <a class="externalLink" href="https://oss.sonatype.org/content/repositories/snapshots/org/microbean/microbean-datasource-cdi-hikaricp/">Sonatype Snapshots</a>.</p>
<p>You will also need a JDBC driver implementation on your classpath as well at runtime.</p>
<h1>Usage</h1>
<p>The microBean Hikari Connection Pool CDI Integration project works, essentially, by satisfying <tt>DataSource</tt> injection points. That is, in your <a class="externalLink" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#part_2">CDI 2.0 SE</a> application somewhere, if you do:</p>

<div class="source">
<div class="source"><pre class="prettyprint">@Inject
@Named(&quot;test&quot;)
private DataSource ds;
</pre></div></div>
<p>&#x2026;this project will arrange for a <tt>DataSource</tt> <a class="externalLink" href="https://static.javadoc.io/com.zaxxer/HikariCP/3.2.0/com/zaxxer/hikari/HikariDataSource.html">backed by the Hikari connection pool</a> to be assigned to <tt>ds</tt> in <a class="externalLink" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#application_context_se">application scope</a>.</p>
<p>For such an injection point to be satisfied, the microBean Hikari Connection Pool CDI Integration project needs to understand how to configure any particular named <tt>DataSource</tt> implementation that will be injected. To do this, it looks for <a class="externalLink" href="https://static.javadoc.io/javax/javaee-api/8.0/javax/annotation/sql/DataSourceDefinition.html"><tt>DataSourceDefinition</tt></a> annotations and <tt>datasource.properties</tt> classpath resources.</p>
<p>Any type-level <tt>DataSourceDefinition</tt> annotations that are encountered are processed. Then <tt>datasource.properties</tt> <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html#getResources-java.lang.String-">classpath resources</a> are sought and loaded, and their properties are processed in the manner described below.</p>
<p>Properties in each <tt>datasource.properties</tt> file are inspected if they start with a datasource name that does not contain a period (&#x2018;<tt>.</tt>&#x2019;) followed by the string <tt>.dataSource.</tt> followed by the name of a <a class="externalLink" href="https://github.com/brettwooldridge/HikariCP/blob/dev/README.md#configuration-knobs-baby">Hikari connection pool configuration setting</a>. <b>Note that in some cases these properties will therefore contain the seemingly redundant string <tt>.dataSource.dataSource.</tt>.</b></p>
<p>Properties are not read until all <tt>datasource.properties</tt> <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html#getResources-java.lang.String-">classpath resources</a> have been effectively combined together.</p>
<p><tt>datasource.properties</tt> <a class="externalLink" href="https://docs.oracle.com/javase/8/docs/api/java/lang/ClassLoader.html#getResources-java.lang.String-">classpath resources</a> override <a class="externalLink" href="https://static.javadoc.io/javax/javaee-api/8.0/javax/annotation/sql/DataSourceDefinition.html"><tt>DataSourceDefinition</tt></a> annotation values.</p>
<p>For each distinct data source name, a <a class="externalLink" href="https://static.javadoc.io/com.zaxxer/HikariCP/3.2.0/com/zaxxer/hikari/HikariDataSource.html"><tt>HikariDataSource</tt></a> is created and made available in <a class="externalLink" href="http://docs.jboss.org/cdi/spec/2.0/cdi-spec.html#application_context_se">application scope</a> with a <a class="externalLink" href="https://static.javadoc.io/javax/javaee-api/8.0/javax/inject/Named.html"><tt>Named</tt></a> qualifier whose <a class="externalLink" href="https://static.javadoc.io/javax/javaee-api/8.0/javax/inject/Named.html#value--">value</a> is set to the data source name. That <tt>DataSource</tt> implementation will then be configured by applying all the relevant property suffixes after the first <tt>.dataSource.</tt> string. So, for example, the property <tt>test.dataSource.dataSource.url=jdbc:h2:mem:temp</tt> will result in a <tt>HikariDataSource</tt> implementation named <tt>test</tt>, with the <a class="externalLink" href="https://github.com/brettwooldridge/HikariCP/blob/dev/README.md#configuration-knobs-baby">Hikari connection pool setting</a> named <tt>dataSource.url</tt> set to <tt>jdbc:h2:mem:temp</tt>.</p>
<p>Here is an example of a <tt>datasource.properties</tt> file that works with the <a class="externalLink" href="http://www.h2database.com/html/features.html#in_memory_databases">in-memory variant of the H2 database</a>:</p>

<div class="source">
<div class="source"><pre class="prettyprint">test.dataSource.dataSourceClassName=org.h2.jdbcx.JdbcDataSource
test.dataSource.dataSource.url=jdbc:h2:mem:test
test.dataSource.username=sa
test.dataSource.password=
</pre></div></div>
<p>Here is an example of a similar <tt>datasource.properties</tt> file that declares two datasources:</p>

<div class="source">
<div class="source"><pre class="prettyprint">test.dataSource.dataSourceClassName=org.h2.jdbcx.JdbcDataSource
test.dataSource.dataSource.url=jdbc:h2:mem:test
test.dataSource.username=sa
test.dataSource.password=

prod.dataSource.dataSourceClassName=org.h2.jdbcx.JdbcDataSource
prod.dataSource.dataSource.url=jdbc:h2:mem:test
prod.dataSource.username=production
prod.dataSource.password=s3kret
</pre></div></div>
        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2018
<a href="http://microbean.systems/">microBean</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
